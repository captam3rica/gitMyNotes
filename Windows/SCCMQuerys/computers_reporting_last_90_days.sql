select distinct SMS_R_System.Name, SMS_R_System.ResourceDomainORWorkgroup, SMS_R_System.OperatingSystemNameandVersion, SMS_R_System.Client, SMS_G_System_WORKSTATION_STATUS.LastHardwareScan, SMS_R_System.ResourceId from  SMS_R_System inner join SMS_G_System_WORKSTATION_STATUS on SMS_G_System_WORKSTATION_STATUS.ResourceID = SMS_R_System.ResourceId where SMS_G_System_WORKSTATION_STATUS.LastHardwareScan >= DateAdd(day, -90,GetDate()) and SMS_R_System.Name like "%KSUP%"
